<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Entrada</title>
    <link rel="shortcut icon" href="./IMAGENS/Logo Icone.ico" type="image/x-icon">
    <link rel="stylesheet" href="./ENTRADA_PRODUTOS/styles.css">
    <script src="./ENTRADA_PRODUTOS/app.js" defer></script>
</head>
<body>
    <div class="header">
        <img src="./IMAGENS/Reciclar_Logo_Principal_Vertical_Negativo.png" alt="Logo Esquerdo" class="logo">
        <h1>ENTRADA</h1>
        <img src="./IMAGENS/Layout.png" alt="Home" class="home-icon" onclick="irParaHome()">
    </div>
    <div class="container">
        <form id="dataForm">
            <label for="sku">SKU:</label>
            <input type="text" id="sku" required>
            <label for="descricao">Descrição:</label>
            <input type="text" id="descricao" required>
            <label for="tipo">Tipo:</label>
            <select id="tipo" required>
                <option value="FRUTA">FRUTA</option>
                <option value="VERDURA">VERDURA</option>
                <option value="LEGUMES">LEGUMES</option>
                <option value="BOVINA">BOVINA</option>
                <option value="AVE">AVE</option>
                <option value="SUÍNA">SUÍNA</option>
                <option value="PESCADO">PESCADO</option>
                <option value="OVOS">OVOS</option>
                <option value="MERCADO">MERCADO</option>
            </select>
            <label for="unidade">Unidade:</label>
            <input type="text" id="unidade" required>
            <label for="grupo">Grupo:</label>
            <select id="grupo" required>
                <option value="MANTIMENTOS">MANTIMENTOS</option>
                <option value="HORTALIÇAS">HORTALIÇAS</option>
                <option value="PROTEINAS">PROTEINAS</option>
                <option value="DOAÇÕES">DOAÇÕES</option>
            </select>
            <label for="quantidade">Quantidade:</label>
            <input type="number" id="quantidade" required oninput="calcularValorTotal()">
            <label for="valor_unitario">Valor Unitário (R$):</label>
            <input type="number" id="valor_unitario" required oninput="calcularValorTotal()" step="0.01">
            <label for="valor_total">Valor Total (R$):</label>
            <input type="number" id="valor_total" required readonly>
            <label for="fornecedor">Fornecedor:</label>
            <input type="text" id="fornecedor" required>
            <label for="data_cadastro">Data Cadastro:</label>
            <input type="date" id="data_cadastro" required>
            <label for="data_vencimento">Data Vencimento:</label>
            <input type="date" id="data_vencimento" required>
            <button type="submit">Salvar</button>
            <button type="button" onclick="limparFormulario()">Limpar</button>
            <button type="button" onclick="irParaHome()">Voltar para Home</button>
        </form>
        <div id="output"></div>
    </div>

    <script>
        document.getElementById('dataForm').addEventListener('submit', (e) => {
            e.preventDefault();

            const sku = document.getElementById('sku').value;
            const descricao = document.getElementById('descricao').value;
            const tipo = document.getElementById('tipo').value;
            const unidade = document.getElementById('unidade').value;
            const grupo = document.getElementById('grupo').value;
            const quantidade = document.getElementById('quantidade').value;
            const valor_unitario = document.getElementById('valor_unitario').value;
            const valor_total = document.getElementById('valor_total').value;
            const fornecedor = document.getElementById('fornecedor').value;
            const data_cadastro = document.getElementById('data_cadastro').value;
            const data_vencimento = document.getElementById('data_vencimento').value;

            const produto = {
                sku,
                descricao,
                tipo,
                unidade,
                grupo,
                quantidade,
                valor_unitario,
                valor_total,
                fornecedor,
                data_cadastro,
                data_vencimento
            };

            // Simulando o salvamento na planilha sem autenticação
            const apiUrl = 'https://institutoreciclar-my.sharepoint.com/:x:/g/personal/admin_institutoreciclar_onmicrosoft_com/EeoXLN5P2P9LuOkVdT10Nk0BQ2fx53aLjfepQMkD270aCg?e=njeHen'; // Substitua pelo seu endpoint público da planilha

            fetch(apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ produto })
            }).then(response => response.json())
            .then(data => {
                console.log('Valor salvo na planilha: ', data);
                alert("Produto salvo com sucesso!");
                document.getElementById('dataForm').reset();
            }).catch(error => console.error('Erro ao salvar na planilha: ', error));
        });

        // Função para calcular o valor total
        function calcularValorTotal() {
            const quantidade = document.getElementById('quantidade').value;
            const valor_unitario = document.getElementById('valor_unitario').value;
            const valor_total = quantidade * valor_unitario;
            document.getElementById('valor_total').value = valor_total.toFixed(2);
        }

        // Função para limpar o formulário
        function limparFormulario() {
            document.getElementById('dataForm').reset();
        }

        // Função para ir para a home
        function irParaHome() {
            window.location.href = "./home.html"; // Substitua pelo caminho correto para a página inicial
        }
    </script>
</body>
</html>
